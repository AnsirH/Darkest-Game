## 1. 개요

횃불은 **던전 탐험 중 파티의 시야와 전투 난이도에 직접적인 영향을 주는 자원 시스템**이다. Room(방)이나 Hallway(복도)의 Tile(타일)을 이동하거나 전투가 진행됨에 따라 횃불 게이지가 감소하며, 게이지 상태에 따라 게임 플레이 난이도가 변한다.

---

## 2. 목적

- 던전 탐험에 긴장감을 부여하는 **리스크 관리 요소** 구현
- 플레이어가 **자원(횃불)을 관리**하며 탐험을 이어가도록 유도
- 횃불 밝기 상태에 따른 **전투 난이도 변화** 제공

---

## 3. 기능 요구사항

### 3.1 횃불 게이지

- [REQ-TORCH-01] 횃불 게이지는 **0~100% 범위**의 값으로 관리된다.
- [REQ-TORCH-02] 기본 시작 값은 **100%**이다.
- [REQ-TORCH-03] 게이지는 Room 또는 Tile 이동, 전투 진행에 따라 감소한다.
- [REQ-TORCH-04] 게이지는 횃불 아이템 사용 또는 특정 기술 사용으로 회복할 수 있다.
- [REQ-TORCH-05] 게이지는 최소 0%, 최대 100%를 초과하지 않는다.

### 3.2 횃불 상태 단계

- [REQ-TORCH-06] 횃불 게이지에 따라 3단계 상태를 가진다.
    - 밝음 (66~100%) → 전투 난이도 ↓
    - 보통 (33~65%) → 기본 전투 난이도
    - 어두움 (0~32%) → 전투 난이도 ↑
- [REQ-TORCH-07] 상태 변화 시, 화면 효과(밝기 변화, 색감 변화 등)를 적용한다.

### 3.3 전투 연계

- [REQ-TORCH-08] 전투 시작 시, 현재 횃불 상태를 전투 난이도에 반영한다.
- [REQ-TORCH-09] 어두운 상태일 경우 적의 스탯(공격력, 회피율 등)을 강화한다.
- [REQ-TORCH-10] 밝은 상태일 경우 플레이어의 명중률을 보정한다.

### 3.4 UI 요구사항

- [REQ-TORCH-11] 횃불 게이지는 화면 상단 HUD에 표시된다.
- [REQ-TORCH-12] 게이지는 숫자(%)와 시각적 막대바 형태로 동시에 표현된다.
- [REQ-TORCH-13] 횃불 상태 단계가 변할 때, HUD 색상 변화 및 메시지를 표시한다.
- [REQ-TORCH-14] 횃불이 0%가 되면 "횃불이 꺼졌다!"라는 경고 메시지를 띄운다.

---

## 4. 비기능 요구사항

- [NFR-TORCH-01] 횃불 게이지 감소 연산은 **매 초 단위**로 실행되어야 한다.
- [NFR-TORCH-02] UI 업데이트는 **0.1초 이내**로 반영되어야 한다.
- [NFR-TORCH-03] 화면 효과(밝기, 색감)는 **프레임 드랍 없이** 적용되어야 한다.

---

## 5. 예외 처리

- [EXC-TORCH-01] 게이지가 0%일 경우, 더 이상 감소하지 않고 0%에서 고정된다.
- [EXC-TORCH-02] 회복 아이템 사용 시 게이지가 100%를 초과하지 않는다.
- [EXC-TORCH-03] 횃불 상태가 변하는 시점에 UI 갱신이 누락되지 않도록 한다.